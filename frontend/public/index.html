<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Hide To Survive — Multiplayer Hide & Seek</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="/favicon.svg" />
  <link rel="stylesheet" href="/style.css" />
</head>
<body class="holiday">
  <header class="hts-header" role="banner">
    <nav class="top-actions" aria-label="Top actions">
      <button id="navLogin" class="nav-btn">Login</button>
      <button id="navHow" class="nav-btn">How To Play</button>
      <button id="navPlay" class="nav-btn">Play</button>
    </nav>
  </header>

  <!-- Left hero (fixed) — large logo here so it doesn't overlap the card -->
  <div class="left-hero" aria-hidden="true">
    <img id="siteLogo" src="/logo.png" alt="Game logo" class="left-hero-logo"
         onerror="this.onerror=null; this.src='/logo.svg';" />
  </div>

  <main class="main-content">
    <section id="pageLogin" class="page active">
      <main class="menu-card">
        <h1 class="menu-title">HIDE TO SURVIVE</h1>
        <p class="menu-subtitle">Fast-paced voxel hide-and-seek — multiplayer matches with shields, captures, and tactical play.</p>

        <div class="menu-form">
          <label for="playerName">Name</label>
          <input id="playerName" type="text" placeholder="Player#1234" maxlength="30" />

          <label for="roomId">Room (optional)</label>
          <div style="display:flex; gap:8px; align-items:center;">
            <input id="roomId" type="text" placeholder="default" style="flex:1;" />
            <button id="createRoomBtn" class="btn-secondary">Create Room</button>
          </div>

          <div id="inviteArea" class="invite-area hidden">
            <span id="inviteText" class="invite-text"></span>
          </div>

          <label for="botCount">Bot Count</label>
          <input id="botCount" type="number" min="0" max="32" value="4" />

          <button id="joinBtn" class="btn-primary" style="margin-top:12px;">JOIN MATCH</button>
          <div style="margin-top:8px;color:#9ca3af;font-size:13px;">
            Hint: Click the canvas to lock pointer. Use WASD + mouse. Q to place block, R to remove, E to pick up shield.
          </div>
        </div>
      </main>
    </section>

    <section id="pageHow" class="page">
      <main class="menu-card">
        <h2>HOW TO PLAY</h2>
        <div class="menu-howto">
          <ol>
            <li><strong>Objective</strong>: Survive as a Hider or hunt as the Seeker. Hiders score points by surviving, capturing Seekers, and using shields. Seekers score by tranqing Hiders.</li>
            <li><strong>Roles</strong>:
              <ul>
                <li>Hider — runs, hides, picks up shields, and can capture Seekers by reaching them without being hit.</li>
                <li>Seeker — has the tranquilizer gun. Shoot Hiders to temporarily disable them. If a Hider reaches you they can capture you and take the gun.</li>
              </ul>
            </li>
            <li><strong>Capture rule</strong>: If a Hider gets within capture distance (close range) of the Seeker and remains there without being hit for a short hold time, the Hider captures the Seeker. Roles swap and the capturer (Hider) becomes Seeker and receives the gun. Successful captures award big points.</li>
            <li><strong>Shields</strong>: Shields are world items you can pick up (press E or auto-pick). Shield behavior:
              <ul>
                <li>Durability model: shields block a fixed number of dart hits (default 3) or expire after a duration (default 20s), whichever comes first.</li>
                <li>When a shield absorbs a dart the durability decreases; at 0 the shield breaks.</li>
                <li>Shields can be carried and will be shown in your HUD.</li>
              </ul>
            </li>
            <li><strong>Shooting & Tranquilizer</strong>: The Seeker's darts sedate Hiders (tranq). If the target has an active shield the dart is blocked; the shield loses durability. Sedated players are temporarily out until revived or time passes.</li>
            <li><strong>Block & World Interaction</strong>: Use Q to place a block and R to remove a block in front of you (useful for quick cover). Shields may appear as world blocks or pickups in the voxel landscape.</li>
            <li><strong>Movement</strong>: WASD + mouse; click canvas to lock pointer. Jump with Space (on supported browsers).</li>
            <li><strong>Scoring</strong>: Captures and tranqs award points. Survival time yields small ongoing points.</li>
            <li><strong>Multiplayer tips</strong>: Test with multiple windows. Shields block a few hits — use them wisely. If you become Seeker, try keeping distance and using terrain to your advantage.</li>
          </ol>
        </div>
      </main>
    </section>

    <section id="pagePlay" class="page">
      <canvas id="gameCanvas"></canvas>

      <div id="hud" class="hud hidden">
        <div id="playerDisplayName" class="hud-role"></div>
        <div id="roleLabel" class="hud-role"></div>
        <div id="timerLabel"></div>
        <div id="playersLabel"></div>
        <div id="connectionStatus" style="font-size:0.9rem;color:#9ca3af;"></div>
        <div id="shieldStatus" style="font-size:0.95rem;color:#fef3c7;"></div>
      </div>

      <aside id="leaderboard" class="leaderboard hidden"><h3>Leaderboard</h3><ul id="leaderboardList"></ul></aside>

      <div id="tranqOverlay" class="tranq-overlay hidden"><div class="tranq-overlay-inner"><h2>TRANQUILIZED!</h2><p>You'll recover shortly.</p></div></div>

      <button id="shootBtn" class="shoot-btn">SHOOT</button>
    </section>
  </main>

  <footer class="site-footer">
    <div class="footer-inner">
      <span class="footer-left">© 2025</span>
      <span class="footer-right"><a id="supportLink" href="#" class="support-link">Support</a> — <span class="brand">Survive.com</span></span>
    </div>
  </footer>

  <!-- scripts -->
  <script src="/env.js"></script>
  <script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script src="/initThree.js"></script>
  <script src="/initVoxel.js"></script>
  <script src="/game.js"></script>

  <script>
    (function () {
      function $(id){ return document.getElementById(id); }
      function showPage(id) { document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); const el = document.getElementById(id); if (el) el.classList.add('active'); }
      document.getElementById('navHow').addEventListener('click', (e)=>{ e.preventDefault(); showPage('pageHow'); });
      document.getElementById('navLogin').addEventListener('click', (e)=>{ e.preventDefault(); showPage('pageLogin'); });
      document.getElementById('navPlay').addEventListener('click', (e)=>{ e.preventDefault(); if (window.myId || (window.hts && window.hts.socketConnected)) showPage('pagePlay'); else { alert('Please JOIN MATCH first'); showPage('pageLogin'); } });
      // nicer support link styling via JS fallback if wanted
    })();
  </script>
</body>
</html>
